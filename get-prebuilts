#!/bin/sh
set -e

BASEDIR=$( dirname $0 )

mkdir -p $BASEDIR/prebuilt/common/apps/

# F-Droid Apps

declare -a FDroidApps=(
"fil.libre.repwifiapp_10")
#"net.sourceforge.opencamera_69"
#"org.mozilla.klar_22"
#"org.smssecure.smssecure_208"
#"com.termux_66"
#"com.fsck.k9_26000"
#"org.videolan.vlc_13001307")

echo "Downloading FDroid..."
curl -L -o $BASEDIR/prebuilt/common/apps/FDroid.apk -O -L https://f-droid.org/FDroid.apk
echo "Downloading signature for FDroid..."
curl -L -o $BASEDIR/prebuilt/common/apps/FDroid.apk.asc -O -L https://f-droid.org/FDroid.apk.asc
echo "Checking signature..."
gpg --armor --verify $BASEDIR/prebuilt/common/apps/FDroid.apk.asc $BASEDIR/prebuilt/common/apps/FDroid.apk
echo ""

for app in "${FDroidApps[@]}";
do
    echo "Downloading ${app}..."
    curl -L -o $BASEDIR/prebuilt/common/apps/"${app}".apk -O -L https://f-droid.org/repo/"${app}".apk
    echo "Downloading signature for ${app}..."
    curl -L -o $BASEDIR/prebuilt/common/apps/"${app}".apk.asc -O -L https://f-droid.org/repo/"${app}".apk.asc
    echo "Checking signature..."
    gpg --armor --verify $BASEDIR/prebuilt/common/apps/"${app}".apk.asc $BASEDIR/prebuilt/common/apps/"${app}".apk
    echo ""
done

# Webview signed by Google

echo "Downloading WebView..."
curl -L -o $BASEDIR/prebuilt/common/apps/webview.apk -O -L https://luddit.es/android/replicant6experimental/com.google.android.webview.362610500.apk
echo "DONE"
